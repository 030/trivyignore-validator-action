setup() {
  filename=".trivyignore"

  echo -en "DEF-123 exp:2124-02-15\nCVE-456 exp:2124-02-16" > "${filename}"
}

teardown() {
  echo "found filename: '${filename}'. Removing it..."
  rm "${filename}"
}

@test "inspect cve expiry max one month" {
  run ./src/action.sh
  [ "$status" -eq 1 ]
  regex=".*current date: '2124-02-15' in line: 'DEF-123 exp:2124-02-15' exceeds.*the maximum date of one month. Choose a new date that is.*before: .*"
  [[ "$output" =~ $regex ]]
}
